<?xml version="1.0" encoding="utf-8"?>
<odoo>
    
    <!-- 1. Pestaña "Operaciones" (stock.move) -->
    <record id="view_picking_form_inherit_box_move" model="ir.ui.view">
        <field name="name">stock.picking.form.inherit.box.move</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.view_picking_form"/>
        <field name="arch" type="xml">
            <!-- Buscamos la vista tree dentro del form de picking -->
            <xpath expr="//field[@name='move_ids_without_package']/list/field[@name='quantity']" position="after">
                <field name="box_number" column_invisible="parent.picking_type_code != 'outgoing'"/>
            </xpath>
        </field>
    </record>

    <!-- 2. Pestaña "Operaciones Detalladas" (stock.move.line) -->
    <record id="view_stock_move_line_detailed_operation_tree_inherit_box" model="ir.ui.view">
        <field name="name">stock.move.line.detailed.operation.tree.inherit.box</field>
        <field name="model">stock.move.line</field>
        <field name="inherit_id"
               ref="stock.view_stock_move_line_detailed_operation_tree"/>
        <field name="arch" type="xml">
            
    
            <xpath expr="//field[@name='quantity']" position="after">
                <field name="box_number" column_invisible="context.get('picking_code') != 'incoming'"/>
            </xpath>
        </field>
    </record>

</odoo>